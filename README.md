# master_class_rec_sys_ya_2025

## Установка

1. Установите python 3.12.7
   pyenv install 3.12.7
2. Создайте виртуальное окружение 
   pyenv virtualenv 3.12.7 yaMasterClass2026
3. Клонируйте репозиторий git clone git clone https://github.com/SerSmith/masterClassRecSysYa2025.git
4. cd masterClassRecSysYa2025
5. Активируйте виртуальное окружение
   pyenv activate yaMasterClass2026
6. Установите requirements
   pip install -r requirements.txt
7. Откройте [masterclass.ipynb](masterclass.ipynb)

## Постановка задачи

Вымышленная ситуация, все совпадения, абсолютно случайны :)

Вы работаете в KION - онлайн кинотеатре. Предположим, что у вас есть полка с роликами - "Выступления PML для вас". Сейчас эта полка ранжируется на основе средней пользовательской оценки (Чем больше у объекта средняя пользовательская оценка у айтема, тем выше он в ранжировании). У вашего продакт оунера есть гипотеза, что в полку нужно добавить персонализацию - перейдя к ML ранжированию.

Всего Itemов в полке 100.

В датасете interections содержится информация о залогированных действиях пользователя:

1. user_id - id пользователя
2. item_id - id видео
3. action - тип взаимодействия:
3.1 show - пользователь увидел объект
3.2 click - пользователь кликнул по объекту
4. datetime - дата совершения интеракции

В датасете items содержится информация о свойствах объекта:

1. item_id - id видео
2. genre - жанр
3. mean_users_score - средняя пользовательская оценка(использовалась для ранжирования при сборе логов)

В датасете users содержится информация о поле пользователя:

1. user_id - id видео
2. sex - пол

## Задание:

Представьте, что вы готовите реальную продуктовую модель - подумайте, как вы будете ее применять в жизни.

1. Вам требуется обучить ALS, EASE и SASrec
3. Обучить бустинг, добавив туда фичи и скоры модели из пункта 1


## Структура:

Для подготовки рекомендательной модели:

- [masterclass.ipynb](masterclass.ipynb) - основной ноутбук
- [presentation.pptx](presentation.pptx) - презентация к рассказу
- data
- [interactions.csv](data/interactions.csv) - интеракции
- [items.csv](data/items.csv) - данные объектов
- [users.csv](data/users.csv) - данные пользователей
- [true_relevance.csv](data/true_relevance.csv) - истинная релевантность, можно использовать для сравнения решения с истиной!

- answer (тут спойлеры!)
- [create_data.ipynb](answer/create_data.ipynb) - генерация датсетов
- [masterclass_corrected.ipynb](answer/masterclass_corrected.ipynb) - скорректиированный файл мастеркласса